<div class="bg-white py-12 sm:py-16">
  <div class="mx-auto max-w-7xl px-6 lg:px-8">
    <div class="mx-auto w-full lg:mx-0">
      <h2 class="text-4xl font-semibold tracking-tight text-pretty sm:text-5xl section-line">
        Vos retours
      </h2>
      <h4 class="mt-8 text-lg/8 color-grey-dark">
        Parce que c'est vous qui en parlez le mieux
      </h4>
      <div class="mx-auto mt-10 max-w-2xl border-t border-gray-200 sm:mt-16 sm:pt-16 lg:mx-0 lg:max-w-none">
        
        <!-- Loading State -->
        <div *ngIf="isLoading" class="text-center py-12">
          <p class="text-gray-500">Chargement des témoignages...</p>
        </div>

        <!-- No Feedbacks State -->
        @if (!isLoading && feedbacks.length === 0) {
        <div class="text-center py-12">
          <p class="text-gray-500">Aucun témoignage disponible</p>
        </div>
        }

        <!-- Testimonials Section -->
        @if (!isLoading && feedbacks.length > 0) {
        <section 
          class="relative isolate overflow-hidden bg-white px-6 py-12 sm:py-16 lg:px-8">
          
          <div class="absolute inset-0 -z-10 bg-[radial-gradient(45rem_50rem_at_top,var(--color-indigo-100),white)] opacity-20"></div>
          <div class="absolute inset-y-0 right-1/2 -z-10 mr-16 w-[200%] origin-bottom-left skew-x-[-30deg] bg-white shadow-xl ring-1 shadow-indigo-600/10 ring-indigo-50 sm:mr-28 lg:mr-0 xl:mr-16 xl:origin-center"></div>

          <div class="mx-auto max-w-2xl lg:max-w-2xl">
            <!-- Carousel Container -->
            <div class="relative h-[200px] flex items-center">
              
              <!-- Navigation Arrows -->
              <button
                (click)="previousSlide()"
                class="absolute left-0 top-1/2 -translate-y-1/2 -translate-x-4 z-10 bg-white hover:bg-gray-50 rounded-full p-2 shadow-lg border border-gray-200 transition-all duration-200 hover:scale-110"
                [disabled]="feedbacks.length <= 1">
                <svg class="w-5 h-5 color-grey-dark" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                </svg>
              </button>

              <button
                (click)="nextSlide()"
                class="absolute right-0 top-1/2 -translate-y-1/2 translate-x-4 z-10 bg-white hover:bg-gray-50 rounded-full p-2 shadow-lg border border-gray-200 transition-all duration-200 hover:scale-110"
                [disabled]="feedbacks.length <= 1">
                <svg class="w-5 h-5 color-grey-dark" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                </svg>
              </button>

              <!-- Feedback Content -->
              <figure class="transition-all duration-500 ease-in-out px-12 sm:px-16 w-full">
                <blockquote class="text-center text-xl/8 font-semibold sm:text-xl/9">
                  <p class="transition-opacity duration-300">
                    "{{ currentFeedback?.feedback }}"
                  </p>
                </blockquote>

                <div class="flex justify-center items-center space-x-8 mb-4 mt-8">
                  <div class="color-grey-dark text-lg font-semibold">
                    {{ currentFeedback?.author }}
                  </div>
                  <div class="flex text-yellow-500 text-xl items-center justify-center">
                    <!-- Syntaxe @for corrigée -->
                    @for (star of starsArray; track $index) {
                      <span [class]="star ? 'text-yellow-500' : 'text-gray-300'">★</span>
                    }
                  </div>
                </div>
              </figure>
            </div>

            <!-- Dots Navigation (optionnel) -->
            <div class="flex justify-center mt-6 space-x-2">
              @for (feedback of feedbacks; track feedback.id; let i = $index) {
                <button
                  (click)="goToSlide(i)"
                  class="w-3 h-3 rounded-full transition-colors duration-200"
                  [class]="i === currentIndex ? 'bg-indigo-600' : 'bg-gray-300 hover:bg-gray-400'">
                </button>
              }
            </div>
          </div>
        </section>
      }
      </div>
    </div>
  </div>
</div>