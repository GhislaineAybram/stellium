<div class="bg-white-light py-12 sm:py-16">
  <div class="mx-auto max-w-7xl px-6 lg:px-8">
    <div class="mx-auto w-full lg:mx-0">
      <h2 class="text-3xl font-bold text-center tracking-tight text-pretty color-blue sm:text-4xl lg:text-5xl section-line">
        Ils me font confiance
      </h2>
      <div class="mt-6 text-base text-gray-700 leading-relaxed sm:text-lg w-full">
        <p>
          La relation de confiance est au cœur de mon métier de conseiller en gestion de patrimoine.
        </p>
        <p>
          Découvrez comment j'ai aidé mes clients à concrétiser leurs objectifs patrimoniaux et à sécuriser leur avenir financier.
        </p>
      </div>

      <div class="mx-auto max-w-2xl lg:mx-0 lg:max-w-none">
        
        <!-- Loading State -->
        <div *ngIf="isLoading" class="text-center py-12">
          <p class="text-gray-500">Chargement des témoignages...</p>
        </div>

        <!-- No Feedbacks State -->
        @if (!isLoading && feedbacks.length === 0) {
        <div class="text-center py-12">
          <p class="text-gray-500">Aucun témoignage disponible</p>
        </div>
        }

        <!-- Testimonials Section -->
        @if (!isLoading && feedbacks.length > 0) {
        <section 
          class="relative isolate overflow-hidden bg-white-light px-6 py-12 sm:py-16 lg:px-8">
          
          <div class="absolute inset-0 -z-10 bg-[radial-gradient(45rem_50rem_at_top,var(--color-blue-very-light),white)] opacity-20"></div>
          <div class="absolute inset-y-0 right-1/2 -z-10 mr-16 w-[200%] origin-bottom-left skew-x-[-30deg] bg-white-light shadow-xl ring-1 shadow-[0_20px_25px_-5px_var(--color-blue-medium)] ring-[color:var(--color-blue-very-light)] sm:mr-28 lg:mr-0 xl:mr-16 xl:origin-center"></div>

          <div class="mx-auto max-w-2xl lg:max-w-2xl">
            <!-- Carousel Container -->
            <div class="relative h-[200px] flex items-center">
              
              <!-- Navigation Arrows -->
              <button
                (click)="previousSlide()"
                class="absolute left-0 top-1/2 -translate-y-1/2 -translate-x-4 z-10 bg-white-light hover:bg-gray-50 rounded-full p-2 shadow-lg border border-gray-200 transition-all duration-200 hover:scale-110"
                [disabled]="feedbacks.length <= 1">
                <svg class="w-5 h-5 color-grey-dark" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                </svg>
              </button>

              <button
                (click)="nextSlide()"
                class="absolute right-0 top-1/2 -translate-y-1/2 translate-x-4 z-10 bg-white-light hover:bg-gray-50 rounded-full p-2 shadow-lg border border-gray-200 transition-all duration-200 hover:scale-110"
                [disabled]="feedbacks.length <= 1">
                <svg class="w-5 h-5 color-grey-dark" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                </svg>
              </button>

              <!-- Feedback Content -->
              <figure class="px-6 sm:px-16 py-6 w-full transition-all duration-500 ease-in-out">
                <blockquote class="text-center mx-auto max-w-md text-base italic font-medium sm:text-lg md:text-xl/8">
                  <p class="transition-opacity duration-300">
                    "{{ currentFeedback?.feedback }}"
                  </p>
                </blockquote>

                <div class="flex justify-center items-center space-x-8 mb-4 mt-8">
                  <div class="color-grey-dark text-sm font-semibold sm:text-base">
                    {{ currentFeedback?.author }}
                  </div>
                  <div class="flex text-yellow-500 text-xl items-center justify-center">
                    <!-- Syntaxe @for corrigée -->
                    @for (star of starsArray; track $index) {
                      <span [class]="star ? 'text-yellow-500' : 'text-gray-300'">★</span>
                    }
                  </div>
                </div>
              </figure>
            </div>

            <!-- Dots Navigation (optionnel) -->
            <div class="flex justify-center mt-6 space-x-2">
              @for (feedback of feedbacks; track feedback.id; let i = $index) {
                <button
                  (click)="goToSlide(i)"
                  class="w-3 h-3 rounded-full transition-colors duration-200"
                  [class]="i === currentIndex ? 'bg-blue-medium' : 'bg-gray-300 hover:bg-gray-400'">
                </button>
              }
            </div>
          </div>
        </section>
      }
      </div>
    </div>
  </div>
</div>